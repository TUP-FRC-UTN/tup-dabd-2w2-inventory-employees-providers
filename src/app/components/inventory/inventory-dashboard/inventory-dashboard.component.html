<!-- inventory-dashboard.component.html -->

<app-main-container title="Dashboard de Inventario">
  <!-- KPIs Row -->
  <div class="container-fluid mt-4">
    <div class="row g-4">
      <!-- Total Items -->
      <div class="col-md-3 mb-3">
        <div class="card h-100 shadow-sm border-0">
          <div class="card-body">
            <div class="d-flex align-items-center">
              <div class="rounded-circle bg-primary bg-opacity-10 p-3 me-3">
                <i class="bi bi-box text-primary fs-4"></i>
              </div>
              <div>
                <h6 class="card-subtitle mb-2">Total Items</h6>
                <h2 class="card-title mb-0 fw-bold">{{metrics.totalItems}}</h2>
                <small class="text-muted">Unidades en inventario</small>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Valor Total -->
      <div class="col-md-3 mb-3">
        <div class="card h-100 shadow-sm border-0">
          <div class="card-body">
            <div class="d-flex align-items-center">
              <div class="rounded-circle bg-success bg-opacity-10 p-3 me-3">
                <i class="bi bi-currency-dollar text-success fs-4"></i>
              </div>
              <div>
                <h6 class="card-subtitle mb-2">Valor de Inventario</h6>
                <h2 class="card-title mb-0 fw-bold">$ {{metrics.totalValue.toFixed(2)}}</h2>
                <small class="text-muted">Valor total actual</small>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Items con Stock Bajo -->
      <div class="col-md-3 mb-3">
        <div class="card h-100 shadow-sm border-0">
          <div class="card-body">
            <div class="d-flex align-items-center">
              <div class="rounded-circle bg-danger bg-opacity-10 p-3 me-3">
                <i class="bi bi-exclamation-triangle text-danger fs-4"></i>
              </div>
              <div>
                <h6 class="card-subtitle mb-2">Stock Bajo</h6>
                <h2 class="card-title mb-0 fw-bold">{{metrics.lowStockItems}}</h2>
                <small class="text-muted">Items bajo mínimo</small>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Artículo más utilizado -->
      <div class="col-md-3 mb-3">
        <div class="card h-100 shadow-sm border-0">
          <div class="card-body">
            <div class="d-flex align-items-center">
              <div class="rounded-circle bg-warning bg-opacity-10 p-3 me-3">
                <i class="bi bi-star text-warning fs-4"></i>
              </div>
              <div>
                <h6 class="card-subtitle mb-2">Más Utilizado</h6>
                <h2 class="card-title mb-0 fw-bold text-truncate" style="max-width: 180px;">
                  {{metrics.mostArticleUsed}}
                </h2>
                <small class="text-muted">Mayor rotación</small>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Charts Row -->
    <div class="row mt-4">
      <!-- Stock por Categoría -->
      <div class="col-md-4 mb-4">
        <div class="card shadow-sm border-0 h-100">
          <div class="card-body">
            <h5 class="card-title mb-4">Stock por Categoría</h5>
            <div class="chart-container" style="position: relative; height: 300px;">
              <canvas baseChart
                [type]="'pie'"
                [data]="categoryChartData"
                [options]="chartOptions">
              </canvas>
            </div>
          </div>
        </div>
      </div>

      <!-- Estado de Items -->
      <div class="col-md-4 mb-4">
        <div class="card shadow-sm border-0 h-100">
          <div class="card-body">
            <h5 class="card-title mb-4">Estado de Items</h5>
              <div class="chart-container" style="position: relative; height: 300px;">
                <canvas baseChart
                  [type]="'doughnut'"
                  [data]="conditionChartData"
                  [options]="chartOptions">
                </canvas>
              </div>
            </div>
          </div>
        </div>
  
        <!-- Tendencias de Movimientos -->
        <div class="col-md-4 mb-4">
          <div class="card shadow-sm border-0 h-100">
            <div class="card-body">
              <h5 class="card-title mb-4">Tendencias de Movimientos</h5>
              <div class="chart-container" style="position: relative; height: 300px;">
                <canvas baseChart
                  [type]="'line'"
                  [data]="transactionTrendsChartData"
                  [options]="chartOptions">
                </canvas>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </app-main-container>